@using Epam.FinalTask.BLL.Interfaces;
@using Epam.FinalTask.Ioc;
@using Epam.FinalTask.Entities;
@using Epam.FinalTask.WebPL.Helpers;
@{
    Layout = "~/Layouts/_Layout.cshtml";


    string queryStr = Request.QueryString["ID"];
    if (!queryStr.IsInt() || queryStr.IsEmpty())
    {
        Response.Redirect("/error");
    }

    int userID = int.Parse(queryStr);
    IAccountBL accountBL = DependencyResolver.AccountBL;
    int authorizedUser = accountBL.GetUserIDByLogin(User.Identity.Name);
    if (userID != authorizedUser)
    {
        Response.Redirect("~/error");
    }

    IChannelBL channelBL = DependencyResolver.ChannelBL;
    IEnumerable<Channel> channels = channelBL.GetUserChannels(userID);

}

<section class="col-md-8 col-lg-8 mt-2 bg-white rounded">
    <div class="my-2">
        <h1> Сообщения </h1>
    </div>

    @foreach (var channel in channels)
    {
        <div class="my-3 channel">
            <input type="hidden" value="@channel.ID" />
            <h3> @channel.Title </h3>
            <div> Число сообщений: @channel.Messages.Count </div>
        </div>
    }
</section>
<script src="~/Scripts/ProjectScripts/GoToMessages.js"></script>